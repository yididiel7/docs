__NUXT_JSONP__("/articles/yubikey-login", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W){return {data:[{article:{slug:"yubikey-login",description:"Configure Pop!_OS to accept a Yubikey for login and unlock.\n",layout:"article",title:E,keywords:["Yubikey","Administration"],image:"http:\u002F\u002Fsupport.system76.com\u002Fimages\u002Fsystem76.png",hidden:false,section:"community",toc:[{id:F,depth:t,text:G},{id:H,depth:t,text:I},{id:J,depth:t,text:K},{id:L,depth:z,text:A},{id:M,depth:z,text:B},{id:N,depth:z,text:C},{id:O,depth:t,text:P}],body:{type:"root",children:[{type:b,tag:"h1",props:{id:"login-with-yubikey"},children:[{type:b,tag:e,props:{href:"#login-with-yubikey",ariaHidden:g,tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:E}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"If you have a Yubikey, you can use it to login or unlock  your system."}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"To do this you must install the yubikey-luks package, configure a challenge-response slot on the Yubikey, and then configure the necessary PAM modules."}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:b,tag:q,props:{},children:[{type:a,value:"This guide assumes you are running Pop!_OS"}]}]},{type:a,value:c},{type:b,tag:u,props:{id:F},children:[{type:b,tag:e,props:{href:"#install-packages",ariaHidden:g,tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:G}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"To install the necessary packages, run:"}]},{type:a,value:c},{type:b,tag:l,props:{className:[m]},children:[{type:b,tag:n,props:{className:[o,p]},children:[{type:b,tag:f,props:{},children:[{type:a,value:"sudo apt install -y libpam-yubico yubikey-personalization\n"}]}]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"You may get a question about the PAM configuration line. If so, enter this line:"}]},{type:a,value:c},{type:b,tag:l,props:{className:[m]},children:[{type:b,tag:n,props:{className:[o,p]},children:[{type:b,tag:f,props:{},children:[{type:a,value:"mode=challenge-response\n"}]}]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Don't enable any PAM modules yet.  We'll do that at the end."}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"If you have already installed the package or want to reconfigure it, use this command:"}]},{type:a,value:c},{type:b,tag:l,props:{className:[m]},children:[{type:b,tag:n,props:{className:[o,p]},children:[{type:b,tag:f,props:{},children:[{type:a,value:"sudo dpkg-reconfigure libpam-yubico\n"}]}]}]},{type:a,value:c},{type:b,tag:u,props:{id:H},children:[{type:b,tag:e,props:{href:"#configure-challenge-response-for-your-yubikey",ariaHidden:g,tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:I}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"To enable challenge-response on your Yubikey, type the following command:"}]},{type:a,value:c},{type:b,tag:l,props:{className:[m]},children:[{type:b,tag:n,props:{className:[o,p]},children:[{type:b,tag:f,props:{},children:[{type:a,value:"ykpersonalize -2 -ochal-resp -ochal-hmac -ohmac-lt64 -oserial-api-visible\n"}]}]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"This configures slot 2 for challenge-response, and leaves slot 1 alone."}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Next we need to create some challenge response files, move them to a system wide directory, and secure those files:"}]},{type:a,value:c},{type:b,tag:l,props:{className:[m]},children:[{type:b,tag:n,props:{className:[o,p]},children:[{type:b,tag:f,props:{},children:[{type:a,value:"sudo mkdir \u002Fvar\u002Fyubico\nsudo chown root.root \u002Fvar\u002Fyubico\nsudo chmod 700 \u002Fvar\u002Fyubico\nykpamcfg -2 -v\n"}]}]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"You should receive a message similar to:"}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:b,tag:f,props:{},children:[{type:a,value:"Stored initial challenge and expected response in '$HOME\u002F.yubico\u002Fchallenge-123456'."}]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"You should receive a unique "},{type:b,tag:r,props:{},children:[{type:a,value:Q}]},{type:a,value:" in your output."}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Now, to finish up:"}]},{type:a,value:c},{type:b,tag:l,props:{className:[m]},children:[{type:b,tag:n,props:{className:[o,p]},children:[{type:b,tag:f,props:{},children:[{type:a,value:"sudo mv ~\u002F.yubico\u002Fchallenge-123456 \u002Fvar\u002Fyubico\u002Falice-123456\nsudo chown root.root \u002Fvar\u002Fyubico\u002Falice-123456\nsudo chmod 600 \u002Fvar\u002Fyubico\u002Falice-123456\n"}]}]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Pay close attention when copying\u002Fpasting the commands above.  The "},{type:b,tag:r,props:{},children:[{type:a,value:Q}]},{type:a,value:" and "},{type:b,tag:r,props:{},children:[{type:a,value:"alice-123456"}]},{type:a,value:" needs to match whatever your output is.**"}]},{type:a,value:c},{type:b,tag:u,props:{id:J},children:[{type:b,tag:e,props:{href:"#configure-plugable-authentication-modules",ariaHidden:g,tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:K}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:b,tag:q,props:{},children:[{type:a,value:"Before making any changes to the files listed below, I highly recommend backing up each file, and having a sudo\u002Froot session open in case you need to roll-back."}]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"You need to add the following line to each of the files listed below:"}]},{type:a,value:c},{type:b,tag:l,props:{className:[m]},children:[{type:b,tag:n,props:{className:[o,p]},children:[{type:b,tag:f,props:{},children:[{type:a,value:"auth sufficient pam_yubico.so mode=challenge-response chalresp_path=\u002Fvar\u002Fyubico\n"}]}]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"This configures your system to accept your Yubikey as an acceptable login alternative.  In other words, you can login without a password, just plug the key into a USB port. "},{type:b,tag:q,props:{},children:[{type:a,value:"You can still use your password to login with this setup"}]},{type:a,value:R}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"If you want your Yubiky to be "},{type:b,tag:q,props:{},children:[{type:a,value:"required to login"}]},{type:a,value:", then you need to change "},{type:b,tag:r,props:{},children:[{type:a,value:"sufficient"}]},{type:a,value:" to "},{type:b,tag:r,props:{},children:[{type:a,value:"required"}]},{type:a,value:".  For example:"}]},{type:a,value:c},{type:b,tag:l,props:{className:[m]},children:[{type:b,tag:n,props:{className:[o,p]},children:[{type:b,tag:f,props:{},children:[{type:a,value:"auth required pam_yubico.so mode=challenge-response chalresp_path=\u002Fvar\u002Fyubico\n"}]}]}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"There a a number of other options for PAM.  Check the man pages for more information.  Also, the "},{type:b,tag:e,props:{href:S,rel:[v,w,x],target:y},children:[{type:a,value:"Yubico PAM module"}]},{type:a,value:" page has a pretty good breakdown."}]},{type:a,value:c},{type:b,tag:T,props:{},children:[{type:a,value:c},{type:b,tag:s,props:{},children:[{type:a,value:A}]},{type:a,value:c},{type:b,tag:s,props:{},children:[{type:a,value:B}]},{type:a,value:c},{type:b,tag:s,props:{},children:[{type:a,value:C}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:D,props:{id:L},children:[{type:b,tag:e,props:{href:"#etcpamdcommon-auth",ariaHidden:g,tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:A}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"At a minimum you need to modify this file."}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:U}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"You may need to run "},{type:b,tag:f,props:{},children:[{type:a,value:"pam-auth-update"}]},{type:a,value:" afterwards."}]},{type:a,value:c},{type:b,tag:D,props:{id:M},children:[{type:b,tag:e,props:{href:"#etcpamdlogin",ariaHidden:g,tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:B}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Modifying this file is optional.  This allows you to authenticate to the Linux terminal with your Yubikey."}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:U}]},{type:a,value:c},{type:b,tag:D,props:{id:N},children:[{type:b,tag:e,props:{href:"#etcpamdgdm-password",ariaHidden:g,tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:C}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Modifying this file is also optional.  If you want to login to your Desktop Environment, (e.g. GNOME), you will need to add the auth line to the \u002Fetc\u002Fpam.d\u002Fgdm-password file."}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"Add the auth line immediately below the "},{type:b,tag:q,props:{},children:[{type:a,value:"@include common-auth"}]},{type:a,value:" line."}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:b,tag:q,props:{},children:[{type:a,value:"NOTE: This will allow you to login to your desktop without a password, but you may still be asked to use a password to unlock your keyring.  This prompt should only appear once upon initial login."}]}]},{type:a,value:c},{type:b,tag:u,props:{id:O},children:[{type:b,tag:e,props:{href:"#references",ariaHidden:g,tabIndex:h},children:[{type:b,tag:i,props:{className:[j,k]},children:[]}]},{type:a,value:P}]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"The following sites were used to build this guide:"}]},{type:a,value:c},{type:b,tag:T,props:{},children:[{type:a,value:c},{type:b,tag:s,props:{},children:[{type:b,tag:e,props:{href:"https:\u002F\u002Fdevelopers.yubico.com\u002Fyubico-pam\u002FAuthentication_Using_Challenge-Response.html",rel:[v,w,x],target:y},children:[{type:a,value:"Authentication Using Challenge Response"}]},{type:a,value:V}]},{type:a,value:c},{type:b,tag:s,props:{},children:[{type:b,tag:e,props:{href:S,rel:[v,w,x],target:y},children:[{type:a,value:"Yubico PAM Module"}]},{type:a,value:V}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:"hr",props:{},children:[]},{type:a,value:c},{type:b,tag:d,props:{},children:[{type:a,value:"This article was contributed by "},{type:b,tag:e,props:{href:"https:\u002F\u002Fgithub.com\u002F71nuxadd1ct",rel:[v,w,x],target:y},children:[{type:a,value:"71nuxadd1ct"}]},{type:a,value:R}]}]},dir:"\u002F",path:"\u002Fyubikey-login",extension:".md",createdAt:W,updatedAt:W,authors:[{username:"btkostner",commitUrl:"https:\u002F\u002Fgithub.com\u002Fsystem76\u002Fdocs\u002Fcommit\u002Fb546a49f39fb36d3650e6cb565117b195247563e",avatarUrl:"https:\u002F\u002Favatars.githubusercontent.com\u002Fu\u002F3385679?v=4",profileUrl:"https:\u002F\u002Fgithub.com\u002Fbtkostner"}]},_img:{}}],fetch:{},mutations:void 0}}("text","element","\n","p","a","code","true",-1,"span","icon","icon-link","div","nuxt-content-highlight","pre","language-text","line-numbers","strong","em","li",2,"h2","nofollow","noopener","noreferrer","_blank",3,"\u002Fetc\u002Fpam.d\u002Fcommon-auth","\u002Fetc\u002Fpam.d\u002Flogin","\u002Fetc\u002Fpam.d\u002Fgdm-password","h3","Login with Yubikey","install-packages","Install Packages","configure-challenge-response-for-your-yubikey","Configure Challenge-Response for your Yubikey","configure-plugable-authentication-modules","Configure Plugable Authentication Modules","etcpamdcommon-auth","etcpamdlogin","etcpamdgdm-password","references","References","challenge-123456",".","https:\u002F\u002Fdevelopers.yubico.com\u002Fyubico-pam\u002F","ul","Add the auth line to the top of this file (after the comment block)."," (From Yubikey).","2021-06-18T18:07:14.469Z")));